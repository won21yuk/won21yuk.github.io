---
title: GCP - All openëœ GCP í”„ë¡œì íŠ¸ ë°©í™”ë²½ ì²´í¬ ë° ìŠ¬ë™ ì•Œë¦¼ ì„¤ì •
categories: [GCP]
---

# all open check

ì§€ë‚œ GCP ë°©í™”ë²½ ê·œì¹™ì— ëŒ€í•œ í¬ìŠ¤íŒ…ì„ ìœ„í•´ ê²€ìƒ‰ì„ í•˜ë‹¤ê°€ ì¬ë°ŒëŠ”ê±¸ í•˜ë‚˜ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.

ëª¨ë“  ì—‘ì„¸ìŠ¤ì— ëŒ€í•´ ì˜¤í”ˆëœ GCP ë°©í™”ë²½ ê·œì¹™ì„ ì°¾ì•„ì£¼ê³  ì´ë¥¼ ìŠ¬ë™ ë©”ì„¸ì§€ë¡œ ì „ì†¡í•´ì£¼ëŠ” ì½”ë“œê°€ ë°”ë¡œ ê·¸ê²ƒì…ë‹ˆë‹¤.

ì €ì•¼ ì†Œì†Œí•˜ê²Œ ê°€ì§€ê³  ë†€ë˜ ê°œì¸ í”„ë¡œì íŠ¸ë‹ˆ ë¬¸ì œê°€ ìƒê²¨ë„ ê·¸ëƒ¥ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ë©´ ê·¸ë§Œì¸ë°, ë§Œì•½ íšŒì‚¬ê°™ì´ ë” ë§ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆëŠ” í”„ë¡œì íŠ¸ë¥¼ ê´€ë¦¬í•˜ëŠ” ê³³ì—ì„œ ì €ì™€ ê°™ì€ ì¼ì´ ìƒê²¼ë‹¤ë©´ ì–´ë• ì„ê¹Œ í•˜ëŠ” ìƒê°ì´ ë¶ˆì‘¥ ë“¤ì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬í•œ ìƒí™©ì†ì—ì„œ ê·¸ ì½”ë“œê°€ ìƒë‹¹íˆ ë§¤ë ¥ì ì´ë¼ê³  ëŠê»´ì¡Œê³ , ê·¸ë˜ì„œ ì €ë„ í•œë²ˆ ë”°ë¼ë§Œë“¤ê³  ì‹¶ì–´ì¡ŒìŠµë‹ˆë‹¤.

ê·¼ë° ê·¸ ë¸”ë¡œê·¸ì—ëŠ” ì½”ë“œë§Œ ì˜¬ë¼ì™€ìˆì–´ì„œ ë˜ê²Œ ê°„ë‹¨í•˜ê²Œ ëë‚ ì¤„ ì•Œì•˜ëŠ”ë° ìƒê°ë³´ë‹¤ ì•ì„œì„œ í•´ì•¼ë  ì¼ë“¤ì´ ìˆì–´ì„œ ì¢€ í—¤ë§¸ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê°œì¸ì ì¸ ìš•ì‹¬ìœ¼ë¡œëŠ” ì¢€ ìë™í™”ë˜ë©´ ì¢‹ê² ë‹¤ì‹¶ì—ˆìŠµë‹ˆë‹¤. ì£¼ê¸°ì ìœ¼ë¡œ í™•ì¸ë©”ì„¸ì§€ë¥¼ ë°›ëŠ”ê²Œ ê´€ë¦¬ê°€ ë” í¸í•˜ë‹ˆê¹Œìš”.

ì–´ì¨Œë“  ì´ê²ƒë“¤ì„ ì§„í–‰í•˜ëŠ” ëª¨ë“  ê³¼ì •ë“¤ì„ ì¢…í•©ì ìœ¼ë¡œ ì •ë¦¬í•´ë³´ê³  ì‹¶ì–´ì„œ ë‚˜ë¦„ ê°„ë‹¨í•˜ê²Œ ê¸°íšì•ˆ ì§œê³  ì´ê²ƒì €ê²ƒ í•´ë³´ë ¤í•©ë‹ˆë‹¤. ë§Œì•½ ì™„ì„±í•˜ë©´ ë‚˜ì¤‘ì— ë² ë¦¬ì—ì´ì…˜ë„ ë‹¤ì–‘í•˜ê²Œ ì¤„ ìˆ˜ ìˆì–´ì„œ ìƒë‹¹íˆ ê´œì°®ì„ ë“¯í•˜êµ¬ìš”.

---

# âœ… ALL-OPEN ë°©í™”ë²½ ì²´í¬ ìë™í™” in GCP

## âš’ï¸ì‚¬ìš© íˆ´

**IDE**

- Pycharm

**êµ¬í˜„**

- Python3 : v 3.7
- Google-api-python-client : v 2.65
- oauth2client : v 4.1.3
- pandas: v 1.3.5
- tabulate: v 0.9.0
- Gcloud CLI : v 405.0.0

**ìë™í™”**

- Airflow
- GCP Composer

**ë²„ì „ê´€ë¦¬**

- Git/Github

## ğŸ’¡ ì•„ì´ë””ì–´

- all-open ë°©í™”ë²½ì€ í•´í‚¹ì— ìƒë‹¹íˆ ì·¨ì•½í•¨.
- í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ëš«ë ¤ë„ GCP ë³´ì•ˆ ê·œì •ìƒ **ì „ì²´ í”„ë¡œì íŠ¸ê°€ ë¸”ë½**ê±¸ë¦´ ìˆ˜ ìˆìŒ
- ì´ë•Œë¬¸ì— ì •ê¸°ì ì¸ all-open ë°©í™”ë²½ì˜ ì¡´ì¬ë¥¼ í™•ì¸í•  í•„ìš”ê°€ ì¡´ì¬
- í”„ë¡œì íŠ¸ì˜ ê·œëª¨ê°€ ì»¤ì§ˆ ìˆ˜ë¡ ê·¸ í•„ìš”ëŠ” ë” ì¦ê°€í•¨

## ğŸ“ ê³„íš

- Python ì½”ë“œë¡œ all-open ë°©í™”ë²½ ì¡°íšŒ ë° Slack ë©”ì„¸ì§€ ì „ì†¡
- Airflowë¡œ ìŠ¤ì¼€ì¥´ë§í•˜ì—¬ ì •ê¸°ì ì¸ all-open ë°©í™”ë²½ ì²´í¬
- GCP Composerë¥¼ ì‚¬ìš©í•´ ì •ê¸°ì ì¸ all-open ë°©í™”ë²½ ì²´í¬
- Gitê³¼ Githubìœ¼ë¡œ Airflow DAG ë²„ì „ê´€ë¦¬

---

# All-open ë°©í™”ë²½ ì²´í¬

*ë³¸ í¬ìŠ¤íŒ…ì€ **ê°œì¸ windows OS ë¡œì»¬ í™˜ê²½**ì—ì„œ IDE(Pycharm)ë¥¼ ì‚¬ìš©í•˜ì—¬ python ì½”ë“œë¡œ ì‚¬ìš©ìì˜ íŠ¹ì • GCP í”„ë¡œì íŠ¸ì— ì†í•œ ì¸ìŠ¤í„´ìŠ¤ë“¤ì˜ ë°©í™”ë²½ ì„¤ì •ì„ ì²´í¬í•˜ê¸° ìœ„í•œ ê³¼ì •ì…ë‹ˆë‹¤.*

## ê¸°ì´ˆ ì„¸íŒ…

ìš°ì„  ì œì¼ ë¨¼ì €í•´ì•¼í•˜ëŠ”ê±´ Compute Engine APIë¥¼ Enableìƒíƒœë¡œ ë§Œë“œëŠ”ê²ë‹ˆë‹¤. ê¸°ì¡´ì— VMì„ ë§Œë“  ì ì´ ìˆë‹¤ë©´, ë‹¹ì—°íˆ Enable ìƒíƒœì…ë‹ˆë‹¤.

APIê°€ ì •ìƒì ìœ¼ë¡œ ì‚¬ìš©ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ [ì—¬ê¸°](https://console.developers.google.com/apis/api/compute)ë¥¼ ëˆ„ë¥´ë©´ ë©ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ ìƒíƒœì— ì‚¬ìš©ì„¤ì •ë¨ì´ë¼ê³  ëœ¨ë©´ ì •ìƒì…ë‹ˆë‹¤.

![firewall-check1](/images/firewall-check1.png)

ê·¸ ë‹¤ìŒì—ëŠ” ì¸ì¦ ì„¤ì •ì„ í•´ì•¼í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„  ìš°ì„ ì ìœ¼ë¡œ Google Cloud SDK ì¤‘ í•˜ë‚˜ì¸ Google Cloud CLI(gcloud CLI)ë¥¼ ì„¤ì¹˜í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.

ì„¤ì¹˜ëŠ” [ê´€ë ¨ í˜ì´ì§€](https://cloud.google.com/sdk/docs/install-sdk)ë¥¼ ë³´ë©´ ë©ë‹ˆë‹¤.

![firewall-check2](/images/firewall-check2.png)

windowsë²„ì „ì€ ê·¸ëƒ¥ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ ë°›ì•„ì„œ ì‹¤í–‰ì‹œí‚¤ê¸°ë§Œ í•˜ë©´ë©ë‹ˆë‹¤.

ë°”íƒ•í™”ë©´ì— ë°”ë¡œê°€ê¸°ë¥¼ ìƒì„±í•˜ê³ , ì´ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ë©´ í„°ë¯¸ë„ì´ í•˜ë‚˜ ëœ¹ë‹ˆë‹¤. ì´ê²ƒì´ Google Cloud CLIì…ë‹ˆë‹¤.

![firewall-check3](/images/firewall-check3.png)

ì´ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë³¸ ì‚¬ìš©ì ì¸ì¦ ì •ë³´(ADC)ë¥¼ ì„¤ì •í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.

ADCëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ê²€ìƒ‰í•˜ê³  ì´ëŸ¬í•œ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ Google Cloud APIì— ì¸ì¦í•˜ê¸° ìœ„í•´Â Cloud í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° Google API í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì‚¬ìš©ë˜ëŠ” ì „ëµì…ë‹ˆë‹¤.

ADCë¥¼ ì„¤ì •í•˜ê³  í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” Google Cloud ì„œë¹„ìŠ¤ ë° APIì— ëŒ€í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸ì¦ ë°©ë²•ì„ ë³€ê²½í•˜ì§€ ì•Šê³  ê°œë°œ ë˜ëŠ” í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì½”ë“œ ì‘ì„± ë•Œ, [ë°©í™”ë²½ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” API](https://cloud.google.com/compute/docs/reference/rest/v1/firewalls/list?hl=id-ID)ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ADCê°€ í•„ìš”í•œ ê²ƒì…ë‹ˆë‹¤.

[ê³µì‹í™ˆí˜ì´ì§€](https://cloud.google.com/docs/authentication/provide-credentials-adc)ì—ëŠ” ì—¬ëŸ¬ í™˜ê²½ì— ë”°ë¼ ADC ì„¤ì •í•˜ëŠ” ë°©ë²•ì´ ì˜ ì„¤ëª…ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì „ ì•ì„œ ë§í–ˆë“¯ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ì•„ë˜ ëª…ë ¹ì–´ë¥¼ CLIì— ì…ë ¥í•´ì¤ë‹ˆë‹¤.

```bash
# In Google Cloud CLI

gcloud beta auth application-default login
```

ëª…ë ¹ì–´ì¹˜ë©´ í„°ë¯¸ë„ ì°½ì´ í•˜ë‚˜ ë” ì—´ë¦¬ê³  betaê°€ ì„¤ì¹˜ë ê²ë‹ˆë‹¤.

ì„¤ì¹˜ê°€ ëë‚˜ë©´ ë‹¤ì‹œ ì›ë˜ gcloud CLIë¡œ ëŒì•„ì™€ì„œ ìœ„ì˜ ì»¤ë§¨ë“œë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.

ì´ì   ì›¹ë¸Œë¼ìš°ì €ê°€ ì¼œì§€ê³  êµ¬ê¸€ ê³„ì • ì„ íƒ í˜ì´ì§€ê°€ ë³´ì¼ê²ë‹ˆë‹¤. **GCPì— ê°€ì…í•œ ê³„ì • í´ë¦­ â†’ í—ˆìš©** í•˜ê³  ì•„ë˜ì™€ ê°™ì€ ì°½ì´ ëœ¨ë©´ ì™„ë£Œëœê²ë‹ˆë‹¤,

![firewall-check4](/images/firewall-check4.png)

ê·¸ë¦¬ê³  ë‹¤ì‹œ gcloud CLIë¡œ ê°€ë©´, ì•„ë˜ì™€ ê°™ì€ ë©”ì„¸ì§€ë“¤ì´ ì¶œë ¥ë˜ì–´ ìˆì„ ê²ë‹ˆë‹¤.

![firewall-check5](/images/firewall-check5.png)

Credentials saved to fileì€ ì¸ì¦íŒŒì¼(application_default_credentials.json)ì´ ì €ì¥ë˜ì–´ìˆëŠ” ê²½ë¡œë¥¼ ì˜ë¯¸í•˜í•©ë‹ˆë‹¤. Google cloud librariesëŠ” í•´ë‹¹ ê²½ë¡œì— ìœ„ì¹˜í•œ json íŒŒì¼ì„ ì½ê³  ì ‘ê·¼ì„ í—ˆìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

Quota project "í”„ë¡œì íŠ¸ëª…" was added to ADC â€¦ ì€ í”„ë¡œì íŠ¸ê°€ ADCì— ì¶”ê°€ë˜ì—ˆìŒì„ ì•Œë¦¬ëŠ” ë©”ì„¸ì§€ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œê±´ í°ë”°ìŒí‘œ(â€) ì‚¬ì´ì—ìˆëŠ” í”„ë¡œì íŠ¸ ëª…ì„ ë³„ë„ë¡œ ì €ì¥í•´ë‘¬ì•¼í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

ì•„ë§ˆ ìì‹ ì˜ í”„ë¡œì íŠ¸ëª… + ìˆ«ìë¡œ ëœ í˜•íƒœì¼í…ë° ì´í›„ ì½”ë“œì—ì„œ í”„ë¡œì íŠ¸ëª…ì„ ì ì„ ë•Œ, ì´ê²ƒì„ ì‚¬ìš©í•´ì•¼ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

## ë°©í™”ë²½ ë¦¬ìŠ¤íŠ¸ ì²´í¬ ì½”ë“œ ì„¸íŒ…

ìš°ì„  ë‘ê°œì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•´ ì¤„ê²ë‹ˆë‹¤.

```python
# êµ¬ê¸€ API í˜¸ì¶œí•˜ê¸° ìœ„í•œ íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
pip install google-api-python-client

# ADC ì¸ì¦ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
pip install oauth2client
```

GCPëŠ” [ë°©í™”ë²½ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” APIì™€ ê·¸ ì˜ˆì‹œ](https://cloud.google.com/compute/docs/reference/rest/v1/firewalls/list?hl=id-ID)ë¥¼ ì œê³µí•´ì£¼ê¸° ë•Œë¬¸ì— ì´ë¥¼ ê¸°ë°˜ì„ ì‘ì„±í•  ê²ë‹ˆë‹¤. ë°‘ì˜ ì½”ë“œê°€ ë°”ë¡œ ê·¸ê²ƒì…ë‹ˆë‹¤.

```python
"""
BEFORE RUNNING:
---------------
1. If not already done, enable the Compute Engine API
   and check the quota for your project at
   https://console.developers.google.com/apis/api/compute
2. This sample uses Application Default Credentials for authentication.
   If not already done, install the gcloud CLI from
   https://cloud.google.com/sdk and run
   `gcloud beta auth application-default login`.
   For more information, see
   https://developers.google.com/identity/protocols/application-default-credentials
3. Install the Python client library for Google APIs by running
   `pip install --upgrade google-api-python-client`
"""
from pprint import pprint

from googleapiclient import discovery
from oauth2client.client import GoogleCredentials

credentials = GoogleCredentials.get_application_default()

service = discovery.build('compute', 'v1', credentials=credentials)

# Project ID for this request.
project = 'my-project'  # TODO: Update placeholder value.

request = service.firewalls().list(project=project)
while request is not None:
    response = request.execute()

    for firewall in response['items']:
        # TODO: Change code below to process each `firewall` resource:
        pprint(firewall)

    request = service.firewalls().list_next(previous_request=request, previous_response=response)
```

ê²°ê³¼ëŠ” Jsonìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.

```python
{'allowed': [{'IPProtocol': 'tcp', 'ports': ['80']}],
 'creationTimestamp': '2022-10-28T04:41:53.238-07:00',
 'description': '',
 'direction': 'INGRESS',
 'disabled': False,
 'id': '-',
 'kind': 'compute#firewall',
 'logConfig': {'enable': False},
 'name': 'default-allow-http',
 'network': '-',
 'priority': 1000,
 'selfLink': '-',
 'sourceRanges': ['0.0.0.0/0'],
 'targetTags': ['http-server']}
```

sourceRangesë¥¼ ë³´ë©´ í•´ë‹¹ ë°©í™”ë²½ì´ ë³¸ í¬ìŠ¤íŒ…ì—ì„œ íƒ€ê²Ÿí•˜ëŠ” all-open ë°©í™”ë²½ì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìœ„ì˜ ì½”ë“œì—ì„œ sourceRangesì— 0.0.0.0/0ì¸ ê²½ìš°ì— ëŒ€í•˜ì—¬ ì¡°ê±´ì„ ê±¸ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.

## ë°©í™”ë²½ ì²´í¬ ì½”ë“œ

all-open ë°©í™”ë²½ì„ ê±¸ëŸ¬ë‚´ê³ , all-open ë°©í™”ë²½ì˜ ì•„ì´ë””, ì´ë¦„, ì‚¬ìš©ì¤‘ì¸ VPC ë„¤íŠ¸ì›Œí¬, íŠ¸ë˜í”½ ë°©í–¥, ìƒì„±ì¼ìë¥¼ ì¶”ì¶œí•´ì„œ jsoní˜•íƒœë¡œ ê°€ê³µí•˜ì˜€ìŠµë‹ˆë‹¤.

```python
from pprint import pprint

from googleapiclient import discovery
from oauth2client.client import GoogleCredentials

credentials = GoogleCredentials.get_application_default()

service = discovery.build('compute', 'v1', credentials=credentials)

# Project ID for this request.
project = 'ìì‹ ì˜ í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”'  # TODO: Update placeholder value.

request = service.firewalls().list(project=project)
lst = []
while request is not None:
    response = request.execute()

    for firewall in response['items']:
        # TODO: Change code below to process each `firewall` resource:
        sourceRanges = firewall['sourceRanges']
        if '0.0.0.0/0' not in sourceRanges:
            continue

        firewall_id = firewall['id']
        firewall_name = firewall['name']
        firewall_network = firewall['network'].split('/')[-1]
        traffic_direction = firewall['direction']
        creation_date = firewall['creationTimestamp']

        dic = {}
        dic['firewall_id'] = firewall_id
        dic['firewall_name'] = firewall_name
        dic['firewall_network'] = firewall_network
        dic['traffic_direction'] = traffic_direction
        dic['creation_date'] = creation_date
        lst.append(dic)

    request = service.firewalls().list_next(previous_request=request, previous_response=response)

pprint(lst)
```

## ìµœì¢… ì½”ë“œ(ë°©í™”ë²½ ë¦¬ìŠ¤íŠ¸ ì²´í¬ + ìŠ¬ë™ ì „ì†¡)

íŠ¹ì´ì‚¬í•­ìœ¼ë¡œëŠ” pandasì˜ to_markdown ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ tabulateë¥¼ ì„¤ì¹˜ í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.

pandasì˜ to_markdown ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°í”„ë ˆì„ì„ ë§ˆí¬ë‹¤ìš´í˜•íƒœë¡œ ì¶œë ¥í•œ ê°’ì„ ê°ì²´ì— ë‹´ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ ìŠ¬ë ‰ ë©”ì„¸ì§€ê°€ ìë™ìœ¼ë¡œ ê¹”ë”í•œ ë°ì´í„°í”„ë ˆì„ í˜•íƒœë¥¼ ê·¸ë ¤ë‚¼ ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.

```python
pip install tabulate
```

ìŠ¬ë™ì„¤ì •í•˜ëŠ” ë²•ì€ [ë³„ë„ì˜ í¬ìŠ¤íŒ…](https://won21yuk.github.io/posts/%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9C%BC%EB%A1%9C-%EC%8A%AC%EB%9E%99-%EB%A9%94%EC%84%B8%EC%A7%80-%EB%B3%B4%EB%82%B4%EA%B8%B0/)ìœ¼ë¡œ ì •ë¦¬í•´ë‘ì—ˆìŠµë‹ˆë‹¤.

ê·¸ë ‡ê²Œ ì™„ì„±ëœ ìµœì¢… ì½”ë“œì…ë‹ˆë‹¤.

```python
from pprint import pprint

from googleapiclient import discovery
from oauth2client.client import GoogleCredentials

import requests, json
import pandas as pd

credentials = GoogleCredentials.get_application_default()

service = discovery.build('compute', 'v1', credentials=credentials)

# Project ID for this request.
project = 'ìì‹ ì˜ í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”'  # TODO: Update placeholder value.

request = service.firewalls().list(project=project)
lst = []
while request is not None:
    response = request.execute()

    for firewall in response['items']:
        # TODO: Change code below to process each `firewall` resource:
        sourceRanges = firewall['sourceRanges']
        # all open ë°©í™”ë²½ ì—¬ë¶€ ì²´í¬
        if '0.0.0.0/0' not in sourceRanges:
            continue
        # json í˜•íƒœë¡œ ë§Œë“¤ê¸°
        firewall_id = firewall['id']
        firewall_name = firewall['name']
        firewall_network = firewall['network'].split('/')[-1]
        traffic_direction = firewall['direction']
        creation_date = firewall['creationTimestamp']

        dic = {}
        dic['firewall_id'] = firewall_id
        dic['firewall_name'] = firewall_name
        dic['firewall_network'] = firewall_network
        dic['traffic_direction'] = traffic_direction
        dic['creation_date'] = creation_date
        lst.append(dic)

    request = service.firewalls().list_next(previous_request=request, previous_response=response)

# ë°ì´í„° í”„ë ˆì„ ë§Œë“¤ê¸°
df = pd.DataFrame(lst)

# ìŠ¬ë™ì— ì—°ê²° ë° ì‚¬ìš©í•  ë©”ì„¸ì§€ ì„¸íŒ…
slack_webhook_url = "ìì‹ ì˜ webhook URL ì…ë ¥í•˜ì„¸ìš”"

# ìŠ¬ë™ ë©”ì„¸ì§€ëŠ” ë§ˆí¬ë‹¤ìš´ ì–¸ì–´ë¥¼ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ë§ˆí¬ë‹¤ìš´ ì–¸ì–´ë¡œ êµ¬ì„±ë˜ë„ë¡ ì‘ì„±í•´ë„ ë¨.
message_result = ("GCP ì¸ìŠ¤í„´ìŠ¤ ë°©í™”ë²½ì— 0.0.0.0/0 ìœ¼ë¡œ ì˜¤í”ˆ ëœ ë°©í™”ë²½ ì •ì±…ì´ ìˆìŠµë‹ˆë‹¤.\n\n"
                  + "```"
                  + df.to_markdown()
                  + "```"
                  + "\n")
slack_message = ":bell:" + " *ë°©í™”ë²½ ëª¨ë‹ˆí„°ë§* \n" + message_result

# ìŠ¬ë™ì— ë©”ì„¸ì§€ ë³´ë‚´ê¸°
payload = {"text": slack_message,
           "icon_emoji": "false"}
requests.post(slack_webhook_url,
              data=json.dumps(payload),
              headers={"Content-Type": "application/json"})
```

![firewall-check6](/images/firewall-check6.png)

ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ìë™í™” ì‘ì—…ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

# Reference

[Method: firewalls.list | Compute Engine Documentation | Google Cloud](https://cloud.google.com/compute/docs/reference/rest/v1/firewalls/list?hl=id-ID)

[ë¹ ë¥¸ ì‹œì‘: Google Cloud CLI ì„¤ì¹˜ | Google Cloud CLI ë¬¸ì„œ](https://cloud.google.com/sdk/docs/install-sdk)

[GCP - all open ë°©í™”ë²½ ì²´í¬ (tistory.com)](https://burning-dba.tistory.com/126?category=1027247)

[python - Send a pandas dataframe to slack - Stack Overflow](https://stackoverflow.com/questions/63781437/send-a-pandas-dataframe-to-slack)
